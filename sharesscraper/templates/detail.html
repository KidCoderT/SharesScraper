{% extends 'base_layout.html' %}

{% block style %}

    <style>

    .chartTitle {
        font-weight: bold;
        text-align: center;
        text-decoration: underline;
    }

    </style>

{% endblock %}

{% block reset %}{% endblock %}

{% block heroTitle %}
{{ data["heroTitle"] }}
{% endblock %}

{% block heroSubtitle %}
{{ data["heroSubtitle"][0] }}
    <hr>
{{ data["heroSubtitle"][1] }}
{% endblock %}

{% block pageContent %}

    <div class="columns">
        <div class="column">
            <div class="box">
                <h1 class="chartTitle">{{ data["name"] }} bought shares in</h1>
                <canvas id="myfirstchart"></canvas>
            </div>
        </div>

        <div class="column">
            <div class="box">
                <h1 class="chartTitle">{{ data["name"] }} sold shares in</h1>
                <canvas id="mysecondchart"></canvas>
            </div>
        </div>

    </div>

    <div class="box">
        <h1 class="chartTitle">{{ data["name"] }} Net Worth History</h1>
        <canvas id="mythirdchart"></canvas>
    </div>


{% endblock %}

{% block script %}

    <script>

    class newChartjsChart {
        constructor(elementId, chartType, xData, yData, label, optionsList, barDE) {
            this.ctx = document.getElementById(elementId).getContext('2d');
            this.chartType = chartType;
            this.xData = xData;
            this.yData = yData;
            this.label = label;
            this.optionsList = optionsList;
            this.barType = barDE
        }

        createChart() {

            if (this.chartType === "bar") {

                if (this.barType === "I") {
                    this.myChart = new Chart(this.ctx, {
                        // The type of chart we want to create
                        type: this.chartType,

                        // The data for our dataset
                        data: {
                            labels: this.xData,
                            datasets: [{
                                label: this.label,
                                backgroundColor: "#5CB85C",
                                data: this.yData
                            }]
                        },

                        // Configuration options go here
                        options: this.optionsList
                    });
                } else if (this.barType === "D") {
                    this.myChart = new Chart(this.ctx, {
                        // The type of chart we want to create
                        type: this.chartType,

                        // The data for our dataset
                        data: {
                            labels: this.xData,
                            datasets: [{
                                label: this.label,
                                backgroundColor: "#D9534F",
                                data: this.yData
                            }]
                        },

                        // Configuration options go here
                        options: this.optionsList
                    });
                }



            } else if (this.chartType === "line") {

                this.myChart = new Chart(this.ctx, {
                    // The type of chart we want to create
                    type: this.chartType,

                    // The data for our dataset
                    data: {
                        labels: this.xData,
                        datasets: [{
                            label: this.label,
                            data: this.yData,
                            borderColor: "#2A76D9",
                            fill: false
                        }]
                    },

                    // Configuration options go here
                    options: this.optionsList
                });

            }
        }
    }


    chart1 = new newChartjsChart(
        'myfirstchart',
        'bar',
        {{ bought_shares["xData"]|tojson }},
        {{ bought_shares["yData"]|tojson }},
        "Increase in holdings (%)",
        {},
        "I"
    );
    chart1.createChart();


    chart2 = new newChartjsChart(
        'mysecondchart',
        'bar',
        {{ sold_shares["xData"]|tojson }},
        {{ sold_shares["yData"]|tojson }},
        "Decrease in holdings (%)",
        {},
        "D"
    );
    chart2.createChart();


    chart3 = new newChartjsChart(
        'mythirdchart',
        'line',
        {{ net_worth["xData"]|tojson }},
        {{ net_worth["yData"]|tojson }},
        "Net Worth (Cr)",
        {},
        ""
    );
    chart3.createChart();


    </script>

{% endblock %}